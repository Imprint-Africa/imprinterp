<!-- Title -->
<section id="title_section" class="projectsNav">
  <h4>Project Details</h4>
  <p>View information about the project</p>
</section>






<!-- Body Section -->
<section class="body_section">





  <!-- project complete details -->
<section id="detail_section" *ngIf="oppennedProject">

  

    <div id="detail_section_title">
        <h4> Projects Details </h4>
        <button class="btn btn-sm" (click)="moveBackToTeams()">Back To Teams</button>
    </div>

    <div class="item-wrap card-group">

    <div class="detail_section_item">
        <h4>Client Name :<span>{{oppennedProject.clientName}}</span></h4>
    </div>

    <div class="detail_section_item">
      <h4>Project Name :<span>{{oppennedProject.projectName}}</span></h4>
    </div>

    <div class="detail_section_item">
        <h4>Revenue :<span>{{oppennedProject.cost}}</span></h4>
    </div>

    <div class="detail_section_item">
        <h4>Priority :
            <span *ngIf="oppennedProject.priority === 3">High</span>
            <span *ngIf="oppennedProject.priority === 2">Medium</span>
            <span *ngIf="oppennedProject.priority === 1">Low</span>
      </h4>
    </div>

    <div class="detail_section_item">
        <h4 *ngIf="oppennedProject.projectStartDate">Comencement :<span>
            {{oppennedProject.projectStartDate.day}}/
          {{oppennedProject.projectStartDate.month}}/
            {{oppennedProject.projectStartDate.year}}
          </span></h4>
    </div>

    <div class="detail_section_item">
        <h4 *ngIf="oppennedProject.projectEndDate">Complition :<span>
              {{oppennedProject.projectEndDate.day}}/
              {{oppennedProject.projectEndDate.month}}/
            {{oppennedProject.projectEndDate.year}}
          </span></h4>
    </div>

    <div class="detail_section_item">
        <h4>project Status :<span>{{oppennedProject.projectStatus}}</span></h4>
    </div>

  </div>

</section>






<section id="task_section" *ngIf="oppennedProject">

<div id="task_title">
    <h4>Tasks</h4>
    <button class="btn btn-sm" (click)="toggleAddTaskForm()">Add Task</button>
</div>










<!-- Define Tasks Section -->
<section id="addTaskSection" [ngClass]="addTaskSectionStatus ? '' : 'hide'">

<!-- Define Tasks -->
<form id="myAddTaskForm" #myAddTaskForm='ngForm' [formGroup]="addTaskForm"  [ngClass]="addTaskFormStatus ? '' : 'hide'">

    <div id="head">
        <h4>You are adding a task to<span>{{oppennedProject.projectName}}</span>project of<span>{{oppennedProject.clientName}}</span></h4>
    </div>

    <div class="form-group">
        <input type="text" #taskDefineInput class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm"
        formControlName="taskName" [class.is-invalid]="formAddTask.taskName.invalid && formAddTask.taskName.touched" required placeholder="Task">
    </div>

    <div class="form-group">
        <select type="" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm"
        formControlName="assignedTeam" [class.is-invalid]="formAddTask.assignedTeam.invalid && formAddTask.assignedTeam.touched"
            required>
        
            <option value="" disabled selected hidden >Asign Team</option>
            <option *ngFor="let Team of Teams" value='{{Team.name}}'>{{Team.name}}</option>
        
        </select> 
    </div>

    <div class="d-flex">
        <button [disabled]="!addTaskForm.valid" class="btn btn-sm btn-success mr-auto" (click)="showCalender()">Set Dates</button>
    </div> 

</form>







<div id="date_setting" [ngClass]="setTaskDateStatus ? '' : 'hide'">

        <div id="duration_wrap"  class="input-group input-group-sm mb-3 ">

                <div class="input-group-prepend">
                  <span class="input-group-text" id="inputGroup-sizing-sm"><fa name="time"></fa></span>
                </div>

                <input type="number" min="1" placeholder="Duration" [(ngModel)]="taskDuration">

                <div class="input-group-append">
                    <span class="input-group-text" id="inputGroup-sizing-sm">Days</span>
                </div>
              
          </div>





        <div id="calender_wrapper">
            <div id="callender_date" class="d-flex">
          
              <h4 class="col-6" *ngIf="taskFromDate">Start: <span>{{ taskFromDate.day }}/ {{ taskFromDate.month }}/{{ taskFromDate.year }} </span></h4>
              <h4 class="col-6" *ngIf="taskToDate">End: <span>{{taskToDate.day}}/{{taskToDate.month}}/{{ taskToDate.year }}</span> </h4>
            </div>
          
            <ngb-datepicker  #taskDatePicker [minDate]="taskMinDate" [maxDate]="taskMaxDate"  (select)="onTaskDateSelection($event)" [displayMonths]="1" [dayTemplate]="taskCalender" outsideDays="hidden">
            </ngb-datepicker>
          
            <ng-template #taskCalender let-date let-focused="focused" >
              <span class="custom-day"
              
                    [class.focused]="focused"
                    [class.range]="isTaskDateRange(date)"
                    [class.disabled]="isTaskDateOutSide(date)"
                    [class.faded]="isTaskDateHovered(date) || isTaskDateInside(date)"
                    (mouseenter)="taskHoveredDate = date"
                    (mouseleave)="taskHoveredDate = null">
                {{ date.day }}
              </span>
            </ng-template>

        
          </div>
          <div class="d-flex">
                <button class="btn btn-sm btn-success mr-auto" (click)="addTask()">Add Tasks</button>
        </div> 


</div>






</section>
  













<ul class="list-group">

    <li class="list-group-item d-flex" *ngFor="let task of oppennedProject.task"
    [ngClass]="task.taskStatus === 'done' ? 'list-group-item d-flex done' : 'list-group-item d-flex' ">
  
            <div class="d-flex col-3 div_wrap">
                <h4 class="">{{task.taskName}}</h4>
            </div>
    
            <div class="d-flex col-3 div_wrap">
                <h4>{{task.assignedTeam}}</h4>
            </div>

            <div class="d-flex col-2 div_wrap">
                <h4>{{task.taskStartDate.day}}/{{task.taskStartDate.month}}/{{task.taskStartDate.year}}</h4>
            </div>

            <div class="d-flex col-2 div_wrap">
                <h4>{{task.taskEndDate.day}}/{{task.taskEndDate.month}}/{{task.taskEndDate.year}}</h4>
            </div>

            <div class="d-flex col-2 div_wrap">
                <h4>{{task.taskDuration}}Days</h4>
            </div>
    </li>

</ul>

  <div class="d-flex justify-content-end progress-head" *ngIf="oppennedProject.task">
      <span class="fetched-data">{{oppennedProject.progress}}%</span>
  </div>

  <div class="progress" *ngIf="oppennedProject.task">
      <div class="progress-bar" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100" 
      [style.width.%]="oppennedProject.progress"></div>               
  </div>

</section>


<section id="ganttChart_section">

    <div id="info_section" class="clearfix">
            <h4>Gantt Chart</h4>
    </div>

    <app-gantt></app-gantt>

  
</section>




<!-- --- End ---   -->
</section>
